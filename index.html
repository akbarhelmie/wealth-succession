<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Asset-Centric Knowledge Graph</title>
    <script type="text/javascript" src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #030712;
            color: #f9fafb;
            overflow: hidden;
        }
        #graph-container {
            background: radial-gradient(circle at center, #111827, #030712);
        }
      .panel {
            background-color: rgba(17, 24, 39, 0.7);
            backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
      .progress-bar-bg { background-color: #374151; }
        #search-bar {
            background-color: #1f2937;
            border: 1px solid #4b5563;
        }
      .info-list-item { border-bottom: 1px solid #374151; }
      .info-list-item:last-child { border-bottom: none; }
      .flash-update {
            animation: flash 0.8s ease-in-out;
        }
        @keyframes flash {
            0% { background-color: #1f2937; }
            50% { background-color: #374151; }
            100% { background-color: #1f2937; }
        }
    </style>
</head>
<body class="w-screen h-screen">

    <div class="relative w-full h-full flex">
        <div class="absolute top-4 left-4 z-10 w-[320px] h-[calc(100vh-2rem)] p-4 rounded-xl panel flex flex-col">
            <h1 class="text-xl font-bold text-white mb-4">Asset Explorer</h1>
            <input type="text" id="search-bar" placeholder="Search 1000+ assets..." class="w-full p-2 rounded-md text-sm text-gray-200 mb-4">
            
            <div id="left-panel-content" class="flex flex-col gap-6 overflow-y-auto pr-2">
                <div id="default-panel-view">
                     <h2 class="text-lg font-semibold text-white mb-3">Dominant Market Philosophies</h2>
                     <div class="space-y-3">
                         <div><div class="flex justify-between text-sm mb-1"><span>Disruptive Innovation</span><span>35%</span></div><div class="w-full progress-bar-bg rounded-full h-2"><div class="bg-purple-500 h-2 rounded-full" style="width: 35%"></div></div></div>
                         <div><div class="flex justify-between text-sm mb-1"><span>Value & Quality</span><span>25%</span></div><div class="w-full progress-bar-bg rounded-full h-2"><div class="bg-green-500 h-2 rounded-full" style="width: 25%"></div></div></div>
                         <div><div class="flex justify-between text-sm mb-1"><span>Decentralization</span><span>20%</span></div><div class="w-full progress-bar-bg rounded-full h-2"><div class="bg-yellow-500 h-2 rounded-full" style="width: 20%"></div></div></div>
                         <div><div class="flex justify-between text-sm mb-1"><span>Global Macro</span><span>12%</span></div><div class="w-full progress-bar-bg rounded-full h-2"><div class="bg-sky-500 h-2 rounded-full" style="width: 12%"></div></div></div>
                    </div>
                </div>

                <div id="asset-specific-view" class="hidden">
                    <h2 id="vector-title" class="text-lg font-semibold text-white mb-3"></h2>
                    <div id="philosophy-vectors" class="space-y-3"></div>
                </div>

                <div>
                    <h2 class="text-lg font-semibold text-white mb-3">Live Sentiment & News</h2>
                    <div id="sentiment-panel" class="bg-gray-900 p-3 rounded-lg min-h-[80px]">
                        <p class="text-sm font-mono text-gray-400">Select or search an asset.</p>
                    </div>
                </div>
            </div>
        </div>

        <div id="info-panel" class="absolute top-4 right-4 z-10 w-96 p-5 rounded-xl panel hidden max-h-[calc(100vh-2rem)] overflow-y-auto">
            <h2 id="info-title" class="text-xl font-bold text-blue-300 mb-2"></h2>
            <div class="flex items-center gap-2 mb-4">
                 <span id="info-category" class="inline-block bg-blue-500/20 text-blue-300 px-3 py-1 rounded-full text-xs font-semibold"></span>
                 <span id="info-marketcap" class="inline-block bg-gray-600 text-gray-200 px-3 py-1 rounded-full text-xs font-semibold"></span>
            </div>
            <div id="info-details" class="space-y-4"></div>
        </div>

        <div id="graph-container" class="w-full h-full"></div>
    </div>

    <script type="text/javascript">
        let liveSentimentInterval = null;

        const assetData = {
            'bitcoin': {
                label: 'Bitcoin', group: 'crypto', value: 45, marketCap: '$1.4T',
                vectors: { 'Decentralization': 60, 'Digital Gold': 25, 'Inflation Hedge': 15 },
                sentiments:,
                relations: {
                    people:,
                    companies:
                }
            },
            'nvidia': {
                label: 'NVIDIA', group: 'stock', value: 42, marketCap: '$3.1T',
                vectors: { 'AI Dominance': 50, 'Disruptive Growth': 30, 'Geopolitical Chip Race': 20 },
                sentiments:,
                relations: {
                    people:,
                    companies:
                }
            },
            'gold': {
                label: 'Gold', group: 'commodity', value: 35, marketCap: '$15.8T',
                vectors: { 'Safe Haven': 55, 'Inflation Hedge': 30, 'Central Bank Demand': 15 },
                sentiments:,
                relations: {
                    people:,
                    companies:
                }
            },
            'ethereum': {
                label: 'Ethereum', group: 'crypto', value: 38, marketCap: '$450B',
                vectors: { 'Decentralization': 40, 'Smart Contracts': 45, 'DeFi Ecosystem': 15 },
                sentiments:,
                relations: {
                    people:,
                    companies:
                }
            },
            'us_treasury_10y': {
                label: 'US 10-Year Treasury', group: 'bond', value: 30, marketCap: 'N/A (Sovereign Debt)',
                vectors: { 'Risk-Free Benchmark': 60, 'Monetary Policy Signal': 25, 'Global Safe Haven': 15 },
                sentiments:,
                relations: {
                    people:,
                    companies:
                }
            },
            'sp500_etf': {
                label: 'S&P 500 ETF (SPY)', group: 'etf', value: 36, marketCap: '$540B (SPY only)',
                vectors: { 'Diversified Indexing': 70, 'US Market Exposure': 20, 'Passive Investing': 10 },
                sentiments:,
                relations: {
                    people:,
                    companies:
                }
            }
        };
        
        function generateMockData(count) {
            const mockData = {};
            const prefixes =;
            const suffixes =;
            const groups = ['stock', 'etf', 'bond', 'reit', 'mutual_fund', 'private_equity', 'hedge_fund'];
            const genericSentiments =;

            for(let i=0; i < count; i++) {
                const id = `mock_asset_${i}`;
                const group = groups[i % groups.length];
                const label = `${prefixes[i % prefixes.length]} ${suffixes[(i+Math.floor(i/prefixes.length)) % suffixes.length]}`;
                mockData[id] = {
                    label: label,
                    group: group,
                    value: 8 + Math.random() * 12, 
                    marketCap: `$${(Math.random() * 200 + 10).toFixed(0)}B`,
                    vectors: {'Diversified Indexing': 50 + Math.floor(Math.random()*20), 'Sector Focus': 20 + Math.floor(Math.random()*10), 'Risk Managed': 10 + Math.floor(Math.random()*10)},
                    sentiments:], // Cycle through generic sentiments
                    relations: { people:, companies: } // Mock assets have no detailed relations for performance
                };
            }
            return mockData;
        }

        const mockAssets = generateMockData(994); 
        Object.assign(assetData, mockAssets);
        const primaryAssetIds = ['bitcoin', 'nvidia', 'gold', 'ethereum', 'us_treasury_10y', 'sp500_etf'];

        const container = document.getElementById('graph-container');
        const searchBar = document.getElementById('search-bar');
        const defaultPanelView = document.getElementById('default-panel-view');
        const assetSpecificView = document.getElementById('asset-specific-view');
        const vectorTitle = document.getElementById('vector-title');
        const philosophyVectors = document.getElementById('philosophy-vectors');
        const sentimentPanel = document.getElementById('sentiment-panel');
        const infoPanel = document.getElementById('info-panel');
        const infoTitle = document.getElementById('info-title');
        const infoCategory = document.getElementById('info-category');
        const infoMarketCap = document.getElementById('info-marketcap');
        const infoDetails = document.getElementById('info-details');

        let allNodesDataSet = new vis.DataSet(Object.keys(assetData).map(id => ({ id, label: assetData[id].label, group: assetData[id].group, value: assetData[id].value })));
        let primaryNodesDataSet = new vis.DataSet(allNodesDataSet.get({ filter: item => primaryAssetIds.includes(item.id) }));
        let currentDisplayedNodes = new vis.DataSet(primaryNodesDataSet.get()); 
        let edges = new vis.DataSet();
        
        let network = new vis.Network(container, { nodes: currentDisplayedNodes, edges }, {
            nodes: { borderWidth: 2, shape: 'dot', font: { color: '#e5e7eb', size: 14 }, scaling: { label: { min: 14, max: 24 }}},
            edges: { width: 2, color: { color: '#4b5563', highlight: '#a78bfa' }, smooth: { type: 'dynamic' }, arrows: { to: { enabled: true, scaleFactor: 0.7 } } },
            physics: { barnesHut: { gravitationalConstant: -50000, centralGravity: 0.2, springLength: 300, damping: 0.25, avoidOverlap: 0.1 }, solver: 'barnesHut' },
            interaction: { hover: true, navigationButtons: true, keyboard: true },
            groups: {
                crypto:   { color: { background:'#facc15', border: '#eab308' }},
                stock:    { color: { background:'#60a5fa', border: '#3b82f6' }},
                commodity:{ color: { background:'#34d399', border: '#059669' }},
                bond:     { color: { background:'#f87171', border: '#ef4444' }},
                etf:      { color: { background:'#a78bfa', border: '#8b5cf6' }},
                reit:     { color: { background:'#c084fc', border: '#9333ea' }},
                mutual_fund: { color: { background:'#fb7185', border: '#e11d48' }},
                private_equity: {color: {background: '#fdba74', border: '#f97316'}},
                hedge_fund: {color: {background: '#818cf8', border: '#4f46e5'}},
                person:   { shape: 'ellipse', color: { background: '#fb923c', border: '#f97316' }},
                company:  { shape: 'box', color: { background: '#9ca3af', border: '#6b7280' }}
            }
        });

        function updatePanels(assetId) {
            const data = assetData[assetId];
            if (!data) return;

            vectorTitle.innerText = `${data.label} Vectors`;
            philosophyVectors.innerHTML = '';
            Object.entries(data.vectors).forEach(([name, value]) => {
                const colors = { 'Decentralization': 'bg-yellow-500', 'AI Dominance': 'bg-purple-500', 'Safe Haven': 'bg-green-500', 'Digital Gold': 'bg-yellow-600', 'Inflation Hedge': 'bg-orange-500', 'Disruptive Growth': 'bg-pink-500', 'Geopolitical Chip Race': 'bg-red-500', 'Smart Contracts': 'bg-blue-500', 'DeFi Ecosystem': 'bg-indigo-500', 'Risk-Free Benchmark': 'bg-gray-500', 'Monetary Policy Signal': 'bg-teal-500', 'Global Safe Haven': 'bg-cyan-500', 'Diversified Indexing': 'bg-lime-500', 'US Market Exposure': 'bg-emerald-500', 'Passive Investing': 'bg-fuchsia-500', 'Sector Focus': 'bg-rose-500', 'Risk Managed': 'bg-violet-500' };
                const color = colors[name] |
| 'bg-sky-500';
                philosophyVectors.innerHTML += `<div><div class="flex justify-between text-sm mb-1"><span>${name}</span><span>${value}%</span></div><div class="w-full progress-bar-bg rounded-full h-2"><div class="${color} h-2 rounded-full" style="width: ${value}%"></div></div></div>`;
            });
            defaultPanelView.classList.add('hidden');
            assetSpecificView.classList.remove('hidden');

            clearInterval(liveSentimentInterval);
            let sentimentIndex = 0;
            const updateSentiment = () => {
                const sentiment = data.sentiments[sentimentIndex % data.sentiments.length];
                sentimentPanel.innerHTML = `<div class="flex justify-between items-center mb-1"><strong class="text-sm">${sentiment.type}</strong><span class="text-xs font-semibold ${sentiment.color}">${sentiment.impact}</span></div><p class="text-sm font-mono text-gray-300">${sentiment.title}</p>`;
                sentimentPanel.classList.remove('flash-update');
                void sentimentPanel.offsetWidth;
                sentimentPanel.classList.add('flash-update');
                sentimentIndex++;
            };
            updateSentiment();
            if (data.sentiments.length > 1) {
                 liveSentimentInterval = setInterval(updateSentiment, 5000);
            }
        }
        
        function updateInfoPanel(assetId) {
            const data = assetData[assetId];
            if (!data) return;
            
            infoTitle.textContent = data.label;
            infoCategory.textContent = data.group.charAt(0).toUpperCase() + data.group.slice(1).replace(/_/g, ' ');
            infoMarketCap.textContent = `MCap: ${data.marketCap}`;
            infoDetails.innerHTML = '';

            if (data.relations.people && data.relations.people.length > 0) {
                let peopleHtml = '<h3 class="text-md font-semibold text-gray-200 mb-2">Key People</h3><ul class="list-none space-y-2">';
                data.relations.people.forEach(p => {
                    peopleHtml += `<li class="info-list-item pb-2"><p class="font-semibold text-gray-100">${p.label} <span class="text-xs text-purple-400 font-normal ml-1">(${p.role})</span></p><p class="text-xs text-gray-400">${p.philosophy |
| ''}</p></li>`;
                });
                infoDetails.innerHTML += peopleHtml + '</ul>';
            }

            if (data.relations.companies && data.relations.companies.length > 0) {
                 let companiesHtml = '<h3 class="text-md font-semibold text-gray-200 mt-4 mb-2">Related Companies</h3><ul class="list-none space-y-2">';
                 data.relations.companies.forEach(c => {
                    companiesHtml += `<li class="info-list-item pb-2"><p class="font-semibold text-gray-100">${c.label} <span class="text-xs text-gray-400 font-normal ml-1">(${c.role})</span></p></li>`;
                });
                infoDetails.innerHTML += companiesHtml + '</ul>';
            }
            infoPanel.classList.remove('hidden');
        }
        
        function resetToDefaultState(clearSearch = true) {
            clearInterval(liveSentimentInterval);
            defaultPanelView.classList.remove('hidden');
            assetSpecificView.classList.add('hidden');
            sentimentPanel.innerHTML = `<p class="text-sm font-mono text-gray-400">Select or search an asset.</p>`;
            infoPanel.classList.add('hidden');
            
            currentDisplayedNodes.clear();
            currentDisplayedNodes.add(primaryNodesDataSet.get());
            edges.clear();
            if (clearSearch) searchBar.value = '';
            network.fit();
        }

        function displayAndExpandNode(assetId) {
            const data = assetData[assetId];
            if (!data) return;
            
            const nodesToShow =; 
            const edgesToShow =;

            if (data.relations) { // Check if relations exist
                if (data.relations.people) {
                    data.relations.people.forEach(p => {
                        nodesToShow.push({ id: p.id, label: p.label, group: 'person', value: 15 });
                        edgesToShow.push({ from: assetId, to: p.id, label: 'Related To' });
                    });
                }
                if (data.relations.companies) {
                    data.relations.companies.forEach(c => {
                        nodesToShow.push({ id: c.id, label: c.label, group: 'company', value: 15 });
                        edgesToShow.push({ from: assetId, to: c.id, label: 'Related To' });
                    });
                }
            }
            
            currentDisplayedNodes.clear();
            currentDisplayedNodes.add(nodesToShow);
            edges.clear();
            edges.add(edgesToShow);

            network.focus(assetId, { animation: true, scale: 1.2 });
            updatePanels(assetId);
            updateInfoPanel(assetId);
        }

        network.on('click', function(params) {
            if (params.nodes.length > 0) {
                const nodeId = params.nodes; // Corrected: params.nodes is an array
                if (assetData[nodeId]) { 
                    displayAndExpandNode(nodeId);
                }
            } else {
                resetToDefaultState();
            }
        });

        searchBar.addEventListener('input', (e) => {
            const searchTerm = e.target.value.toLowerCase();
            if (searchTerm.length === 0) {
                resetToDefaultState();
                return;
            }
            const filteredNodesData = allNodesDataSet.get({
                filter: item => item.label.toLowerCase().includes(searchTerm) |
| item.group.toLowerCase().includes(searchTerm)
            });
            
            currentDisplayedNodes.clear();
            currentDisplayedNodes.add(filteredNodesData);
            edges.clear();
            
            if (filteredNodesData.length === 0) {
                 sentimentPanel.innerHTML = `<p class="text-sm font-mono text-gray-400">No assets found for "${searchTerm}".</p>`;
                 infoPanel.classList.add('hidden');
                 defaultPanelView.classList.remove('hidden');
                 assetSpecificView.classList.add('hidden');
            } else if (filteredNodesData.length === 1 && assetData.id]) {
                displayAndExpandNode(filteredNodesData.id);
            } else {
                 sentimentPanel.innerHTML = `<p class="text-sm font-mono text-gray-400">Multiple assets found. Click one to explore.</p>`;
                 infoPanel.classList.add('hidden');
                 defaultPanelView.classList.remove('hidden');
                 assetSpecificView.classList.add('hidden');
            }
        });

        network.on("stabilizationIterationsDone", () => network.fit());
        
    </script>
</body>
</html>
